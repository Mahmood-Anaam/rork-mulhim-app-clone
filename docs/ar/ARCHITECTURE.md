# وثيقة الهندسة البرمجية - تطبيق مُلهم

## نظرة عامة
مُلهم هو تطبيق للياقة البدنية والتغذية تم بناؤه باستخدام React Native و Expo. يتبع التطبيق **هندسة نظيفة مدفوعة بالميزات (Feature-Driven Clean Architecture)**، مما يضمن فصلاً صارماً بين واجهة المستخدم، منطق الأعمال، والوصول إلى البيانات.

## هيكل المجلدات
يتم تنظيم المشروع داخل مجلد `src/` للحفاظ على نظافة المستوى الجذري:

- `src/api`: عملاء منخفضو المستوى للخدمات الخارجية (Supabase, tRPC).
- `src/components`: مكونات واجهة المستخدم القابلة لإعادة الاستخدام وغير المرتبطة بالحالة (Button, Input, Card).
- `src/context`: إدارة الحالة العالمية باستخدام React Context (Auth, Language, Fitness).
- `src/hooks`: خطافات (Hooks) مخصصة تغلف منطق الأعمال الخاص بكل مجال وتنسق البيانات.
- `src/services`: خدمات منطق الأعمال، بما في ذلك أنماط المستودعات (Repository Pattern) وتكامل OpenAI.
- `src/screens`: واجهات التطبيق الرئيسية، مفصولة عن منطق التوجيه (Routing).
- `src/types`: واجهات TypeScript وتعاريف الأنواع.
- `src/utils`: وظائف مساعدة، ثوابت، وتكوينات عالمية.

## دورة حياة البيانات
1. **مصدر البيانات**: Supabase (قاعدة بيانات PostgreSQL عن بعد) و AsyncStorage (تخزين مؤقت محلي).
2. **طبقة الخدمة**: `remoteFitnessRepo.ts` يتعامل مع جميع عمليات CRUD مع Supabase.
3. **منطق الأعمال**: الخطافات (Hooks) مثل `useWorkoutPlan` تدير انتقالات الحالة والمزامنة مع الخدمات.
4. **طبقة الواجهة**: الواجهات والمكونات تستهلك البيانات عبر الخطافات، وتظل مستقلة عن مصدر البيانات.

## تكامل المدرب الذكي (AI Coach)
تم نقل المدرب الذكي من Rork AI إلى تنفيذ مخصص باستخدام **OpenAI GPT-4o**.
- **الخدمة**: `openAIService.ts` يتعامل مع التواصل المباشر مع OpenAI API.
- **الخطاف**: `useAICoach.ts` يدير سجل الدردشة ويكتشف التوصيات المهيكلة (التمارين/الوجبات) من ردود الذكاء الاصطناعي.

## تفصيل مكونات واجهة المستخدم

### شاشة الترحيب (Welcome)
- **المكونات**: `View`, `Text`, `TouchableOpacity`, أيقونة `Globe`.
- **الخطاف**: `useLanguage` لضبط لغة التطبيق بالكامل.

### لوحة التحكم (الخطة)
- **المكونات**: `Card`, `ProgressBar`, `CheckCircle`, أيقونة `Dumbbell`.
- **الخطاف**: `useWorkoutPlan` لإدارة الجلسات وإكمال التمارين.

### المدرب الذكي
- **المكونات**: `KeyboardAvoidingView`, `ScrollView`, أيقونة `Bot`, أيقونة `Send`.
- **الخطاف**: `useAICoach` للتفاعل الفوري مع المدرب المدعوم بـ OpenAI.
