# توثيق الشاشات — تطبيق ملهم

## تدفق التنقل

```
التشغيل
  │
  ▼
app/index.tsx (منطق إعادة التوجيه)
  │
  ├─► /welcome           — اختيار اللغة (أول تشغيل)
  │
  ├─► /account-prompt    — تسجيل الدخول أو الاستمرار كضيف
  │     ├─► /auth/login
  │     └─► /onboarding
  │
  ├─► /onboarding        — معالج إعداد الملف الشخصي (7 خطوات)
  │
  └─► /(tabs)            — التنقل الرئيسي بالتبويبات
        ├─ /plan          — خطة التمرين
        ├─ /nutrition     — خطة التغذية
        ├─ /coach         — المدرب الذكي
        └─ /profile       — الملف الشخصي والإعدادات
```

---

## 1. شاشة الترحيب (`/welcome`)

**الملف:** `app/welcome.tsx`  
**تُعرض:** عند أول تشغيل فقط

### الوصف
شاشة اختيار اللغة. تدعم العربية (RTL) والإنجليزية (LTR). يُحفَظ الاختيار في `AsyncStorage`.

### عناصر الواجهة
- أيقونة الكرة الأرضية
- ترحيب عربي: "أهلاً"
- ترحيب إنجليزي: "Hello"
- زران كبيران للغة: **العربية** / **English**
- تذييل باسم التطبيق "ملهم"

### السلوك
1. المستخدم يضغط على زر اللغة
2. تُحفَظ اللغة في `AsyncStorage`
3. يُطبَّق تخطيط RTL إذا اختار العربية
4. إعادة توجيه إلى `app/index.tsx` لتحديد الشاشة التالية

---

## 2. شاشة طلب الحساب (`/account-prompt`)

**الملف:** `app/account-prompt.tsx`  
**تُعرض:** عند عدم وجود ملف شخصي وعدم تسجيل الدخول

### الوصف
يسأل المستخدم عن تسجيل الدخول أو الاستمرار كضيف. مدخل متحرك.

### عناصر الواجهة
- أيقونة المستخدم
- العنوان والوصف (ثنائي اللغة)
- زر **تسجيل الدخول** ← `/auth/login`
- زر **تخطي (الاستمرار كضيف)** ← `/onboarding`

---

## 3. شاشة تسجيل الدخول (`/auth/login`)

**الملف:** `app/auth/login.tsx`

### الوصف
نموذج تسجيل الدخول بالبريد الإلكتروني/كلمة المرور.

### السلوك
- يستدعي `AuthProvider.signIn(email, password)`
- عند النجاح: إعادة توجيه إلى `app/index.tsx`
- عند الفشل: يعرض `Alert` مع رسالة الخطأ

---

## 4. شاشة التسجيل (`/auth/signup`)

**الملف:** `app/auth/signup.tsx`

### الوصف
نموذج إنشاء حساب مع اكتشاف الحسابات المكررة.

---

## 5. شاشة التهيئة (`/onboarding`)

**الملف:** `app/onboarding.tsx`

### الوصف
معالج من 7 خطوات لجمع ملف اللياقة البدنية للمستخدم.

### الخطوات

| الخطوة | البيانات المُجمَّعة |
|--------|---------------------|
| 0 | العمر |
| 1 | الوزن + الطول |
| 2 | الجنس (ذكر/أنثى) |
| 3 | الهدف (إنقاص وزن / بناء عضلات / لياقة عامة) |
| 4 | مستوى النشاط (لا شيء / خفيف / معتدل / عالٍ) |
| 5 | موقع التدريب (صالة / منزل / معدات محدودة) |
| 6 | الأيام المتاحة + مدة الجلسة + الإصابات |

### السلوك
- شريط تقدم يوضح الخطوة الحالية
- التحقق من كل خطوة قبل المتابعة
- عند الإتمام: `FitnessProvider.saveProfile()` ← مزامنة مع Supabase عند تسجيل الدخول
- إعادة توجيه إلى `/(tabs)/plan`

---

## 6. شاشة خطة التمرين (`/(tabs)/plan`)

**الملف:** `app/(tabs)/plan.tsx`

### الوصف
الشاشة الرئيسية لخطة التمرين. تُعرض الخطة الأسبوعية المُولَّدة بالذكاء الاصطناعي.

### الميزات
- **شريط تقدم الأسبوع** — يُظهر الجلسات المكتملة مقابل الإجمالي
- **جلسات التمرين** — بطاقات قابلة للطي لكل يوم تدريب
  - تبديل إتمام الجلسة (دائرة ← علامة صح)
  - قائمة التمارين مع تتبع الإتمام الفردي
  - تعديل التمرين (مجموعات/تكرارات/راحة/وزن)
  - حذف التمرين من الجلسة
  - إضافة تمرين من قاعدة البيانات
  - إعادة توليد الجلسة بتمارين مختلفة
- **التمارين المفضلة** — قسم قابل للطي لإضافة التمارين المحفوظة
- **عرض التقويم** — نظرة عامة على الأسبوع مع حالة الجلسات

### المكونات المستخدمة
- `components/plan/ExerciseItem` — صف التمرين الفردي
- `components/plan/WeekProgressCard` — شريط التقدم

---

## 7. شاشة التغذية (`/(tabs)/nutrition`)

**الملف:** `app/(tabs)/nutrition.tsx`

### الوصف
إدارة التغذية الكاملة: التقييم، خطة الوجبات، وقائمة التسوق.

### الميزات

#### تقييم التغذية
- استبيان تكرار الأغذية (FFQ)
- إدخال تاريخ الوجبات
- يولِّد `NutritionPlan` بـ:
  - السعرات الهدفية (بناءً على TDEE + الهدف)
  - أهداف الماكرو (بروتين/كربوهيدرات/دهون)
  - تصنيف نمط النظام الغذائي

#### خطة الوجبات الأسبوعية
- يعرض خطة وجبات 7 أيام
- كل يوم يُظهر: الإفطار، الغداء، العشاء، السناكات
- تبديل إتمام الوجبة
- إضافة وجبات: من قاعدة بيانات الأطعمة السعودية، من المفضلة، أو مخصصة (ذكاء اصطناعي)
- حذف الوجبات

#### قائمة التسوق
- مُولَّدة تلقائياً من مكونات خطة الوجبات
- العناصر مُجمَّعة حسب الفئة
- تأشير العناصر المشتراة

### المكونات المستخدمة
- `components/nutrition/MacroSummaryCard`
- `components/nutrition/MealCard`

---

## 8. شاشة المدرب الذكي (`/(tabs)/coach`)

**الملف:** `app/(tabs)/coach.tsx`

### الوصف
مدرب محادثة مدعوم بـ OpenAI مع استجابات متدفقة في الوقت الفعلي.

### الميزات
- **واجهة المحادثة** — رسائل من المستخدم والذكاء الاصطناعي كفقاعات
- **إجراءات سريعة** — مطالبات مُعدَّة مسبقاً
- **أدوات الذكاء الاصطناعي:**
  - `suggestWorkout` — اقتراح تمارين
  - `suggestMeal` — اقتراح وجبة سعودية
  - `trackProgress` — تحليل تقدم المستخدم
  - `adjustPlan` — اقتراح تعديلات الخطة
- **حفظ في الخطة** — حفظ التمارين/الوجبات المقترحة مباشرة

### المكونات المستخدمة
- `components/coach/ChatMessage`

---

## 9. شاشة الملف الشخصي (`/(tabs)/profile`)

**الملف:** `app/(tabs)/profile.tsx`

### الوصف
لوحة تحكم المستخدم مع الإحصاءات والإعدادات وإدارة الحساب.

### الأقسام

#### صف الإحصاءات
- الإنجاز الحالي (أيام تمرين متتالية)
- إجمالي التمارين المكتملة
- الوزن الحالي
- تغيير الوزن منذ البداية

#### القياسات الجسدية
- BMR (معدل الأيض الأساسي)
- TDEE (إجمالي الطاقة اليومية)
- BMI (مؤشر كتلة الجسم)

#### الإعدادات
- تبديل اللغة (عربي ↔ إنجليزي)
- تعديل الملف الشخصي
- تسجيل الوزن
- تسجيل الخروج

### المكونات المستخدمة
- `components/profile/ProfileStats`
- `components/ui/StatBox`

### الـ Hooks المستخدمة
- `useProgressStats`
